维基百科离线版 v1.0.4

作者：Todd Liu
邮箱：xxxxxxxxxxxx


+++++++++++++++++++++++++++
+         维基百科，自由的百科全书！          +
+    Wikipedia , the Free Encyclopedia！  +
+++++++++++++++++++++++++++


简介：
        维基百科是一个免费好用的网络百科全书，它是全球网络上最大且最受大众欢迎的参考工具书，名列全球十大最受欢迎的网站。它包罗万象，可谓无所不能，适合学习的时候查资料，维基百科由非营利组织维基媒体基金会负责营运，内容非常的权威，使用方便。可是因为一些众所周知的原因，国内用户是无法使用维基百科的，只能通过科学上网（俗称：番羽 土啬）或一些镜像站点来访问，例如：xxxxxxxxxxxx ，不过可惜这些镜像站点随时可能无法访问。
        于是就有了很多人使用离线维基百科，我最早使用的离线维基百科工具是WikiTaxi，后来换成了更好用的Kiwix-0.9-win，最近更新了kiwix-win-2.0后发现，在Win10系统下设置功能经常卡死导致程序崩溃，于是就开始放弃kiwxi客户端，转而使用kiwix的一个功能kiwix-serve，它可以通过http服务将zim格式的数据库文件内容分发出去，然而该程序是一个没有图形界面的命令行程序，每次使用都要敲命令，为了一劳永逸，我就想到了利用kiwix程序的kiwix-serve服务自己写一个程序来实读取zim格式文件，从而实现离线访问维基百科。


功能：
        本程序可以说是一个通过浏览器实现的zim文件阅读器，它可以帮助我们实现离线访问维基百科。
        1. wikipedia.exe为英文界面程序，可以访问中文、英文维基百科；
        2. 维基百科.exe为中文界面程序，可以访问中文、英文维基百科；
        3. 双击wikipedia.exe或者维基百科.exe后会自动打开默认浏览器，访问kiwix-serve服务搭建好的离线维基百科；
        4. 局域网其他电脑或者手机也可以通过本机IP地址来访问离线维基百科。


注意事项：

      （1）程序运行之后会自动打开默认浏览器来访问地址localhost上的离线维基百科，如果无法打开请检查hosts文件；
      （2）程序运行之后会后台展示一个黑底绿字的命令行窗口，用来展示提示信息，如Kiwix Server IP地址，请勿关闭该窗口，在用户关闭浏览器窗口后，此窗口会自动关闭；
      （3）本程序使用的离线维基百科数据库为kiwix.org组织制作的zim格式文件，使用前请到以下地址下载自己所需语言和学科的zim文件：

        http://download.kiwix.org/zim/wikipedia/

        请将zim文件下载好后，放到程序根目录的 data 文件夹下，程序就会自动识别并在浏览器中展示。

        你可能会使用到的zim文件：

        ① wikipedia_en_all_maxi_2018-10.zim      维基百科英文全库，带图片，大小：78G
        ② wikipedia_zh_all_maxi_2020-03.zim      维基百科中文全库，带图片，大小：14.3G
        ③ 英文学科分库：
            wikipedia_en_chemistry_maxi_2020-03.zim        英文，化学，带图片，大小：295M
            wikipedia_en_computer_maxi_2020-02.zim        英文，计算机，带图片，大小：703M
            wikipedia_en_geography_maxi_2020-01.zim      英文，地理，带图片，大小：944M
            wikipedia_en_history_maxi_2020-02.zim             英文，历史，带图片，大小：1.27G
            wikipedia_en_mathematics_maxi_2020-04.zim   英文，数学，带图片，大小：688M
            wikipedia_en_medicine_maxi_2020-04.zim         英文，医学，带图片，大小：1.6G
            wikipedia_en_physics_maxi_2020-02.zim            英文，物理，带图片，大小：745M
        ④ 中文学科分库：
            wikipedia_zh_chemistry_maxi_2020-01.zim        中文，化学，带图片，大小：70.2M
            wikipedia_zh_computer_maxi_2019-10.zim        中文，计算机，带图片，大小：3.17G
            wikipedia_zh_geography_maxi_2020-02.zim       中文，地理，带图片，大小：179M
            wikipedia_zh_history_maxi_2020-03.zim             中文，历史，带图片，大小：249M
            wikipedia_zh_mathematics_maxi_2020-02.zim    中文，数学，带图片，大小：215M
            wikipedia_zh_medicine_maxi_2020-03.zim          中文，医学，带图片，大小：219M
            wikipedia_zh_physics_maxi_2020-01.zim             中文，物理，带图片，大小：240M

      （4）已知bug：程序运行后，如果打开的是IE浏览器，首次打开需要刷新一下，才会出现网页。
              原因：IE浏览器是最后一个判断的，属于兜底的浏览器，判断时间比较久，程序先打开浏览器，后启动的kiwxi-serve服务，造成首次打开不显示。


更新日志：

=================================
v1.0.4    2020-4-5

* 优化：zim文件复制到data目录下自动识别；
* 优化：显示Kiwix Server IP地址；
* 美化：重新选择Wikipedia.exe程序图标。
=================================


=================================
v1.0.3    2020-4-3

* 优化：判断用户使用的浏览器，绑定kiwix-serve服务到浏览器进程；
* 关闭浏览器后自动关闭kiwix-serve服务窗口；
* 美化：重新选择维基百科.exe程序图标。

=================================


=================================
v1.0.2    2020-4-2

* 优化：使用360极速浏览器改为使用默认浏览器；
* 优化：监听固定IP改为监听本机所有接口IP地址；
* 美化：为程序增加图标，转为exe可执行文件。

=================================


=================================
v1.0.1    2020-4-1

* 使用360极速浏览器浏览kiwix网页；
* 读取data文件夹下固定名称的zim文件；
* 手动关闭kiwix-serve服务窗口。

=================================